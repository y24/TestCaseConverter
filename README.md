# テストケース Excel → Markdown/YAML/CSV 変換ツール

Excel形式のテストケースをMarkdown、YAML、CSV形式に変換するWebアプリケーションです。

## 主な機能

### ファイル変換
- **対応形式**: .xlsx, .xls
- **出力形式**: Markdown (.md), YAML (.yaml), CSV (.csv)
- **一括処理**: 最大20ファイル、総サイズ400MBまで対応
- **自動変換**: ファイルアップロードや設定変更時のリアルタイム変換

### 出力設定
- **ファイル分割**: シート単位 / 大項目単位 / テストケース単位
- **多言語対応**: 日本語・英語の見出し切り替え
- **ケースID**: 自動採番機能（プレフィックス、桁数、開始番号設定可能）
- **カテゴリ階層**: 大項目→中項目→小項目の階層構造対応

### データ処理
- **ヘッダー検索**: 指定列・キーによるヘッダー行の自動検出
- **列マッピング**: 手順、期待結果、前提条件等の柔軟な列設定
- **文字列正規化**: 全角英数字正規化、ステップ数正規化、空白トリム
- **カテゴリ補完**: 空のカテゴリセルを前の行から自動補完

### ユーザーインターフェース
- **レスポンシブデザイン**: PC・タブレット・スマートフォン対応
- **ドラッグ&ドロップ**: 直感的なファイルアップロード
- **リアルタイムプレビュー**: 変換結果の即座確認
- **WYSIWYGプレビュー**: Markdown出力の視覚的プレビュー機能
- **プレビューモード切り替え**: テキスト表示とWYSIWYG表示の自由な切り替え
- **テーマ切り替え**: Light / Dark / System テーマ
- **設定保存**: ブラウザローカルストレージでの設定永続化

## セットアップ

### 初回インストール
```batch
install.bat
```

### 起動
```batch
run.bat
```

起動後、自動的にブラウザでWebUIが開きます。開かない場合は `http://localhost:8765` にアクセスしてください。

## 使用方法

1. **WebUIを開く**: ブラウザでアプリケーションにアクセス
2. **設定調整**: 左サイドバーで変換設定をカスタマイズ
3. **ファイルアップロード**: Excelファイルをドラッグ&ドロップまたはクリックで選択
4. **プレビュー確認**: 変換結果をリアルタイムで確認
   - **テキストプレビュー**: 生のMarkdownテキストを表示
   - **WYSIWYGプレビュー**: レンダリングされたHTMLを視覚的に表示
5. **プレビューモード切り替え**: 「📄 Plain」と「👁 Preview」ボタンで表示形式を切り替え
6. **ダウンロード**: 単体ファイルまたはZIP形式でダウンロード

## 技術仕様

### バックエンド
- **フレームワーク**: Python 3.11+ + FastAPI + Uvicorn
- **Excel処理**: openpyxl
- **データ検証**: Pydantic
- **テンプレート**: Jinja2
- **設定管理**: JSON形式のプロファイル機能

### フロントエンド
- **技術スタック**: Vanilla HTML5 + CSS + JavaScript
- **レスポンシブ**: CSS Grid + Flexbox
- **状態管理**: LocalStorage
- **UI/UX**: モダンなマテリアルデザイン
- **WYSIWYG**: marked.js + DOMPurify（Markdownレンダリング・セキュリティ）

### 出力形式
- **Markdown**: GitHub Flavored Markdown準拠
- **YAML**: 構造化データ形式
- **CSV**: 表計算ソフト対応

## 設定項目

### インプット設定
- 対象シート名の指定
- ヘッダー行の検索条件（列・キー）
- 各データ列のマッピング設定

### 変換設定
- カテゴリツリーの処理方法
- 文字列正規化オプション
- ケースIDの採番設定

### アウトプット設定
- 出力形式の選択
- ファイル分割方法
- 出力項目の選択（基本情報・メタ情報・変換元情報）
